<?xml version="1.0"?>
<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->

<bindings id="ircStatsPanelBindings"
          xmlns="http://www.mozilla.org/xbl"
          xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
          xmlns:xbl="http://www.mozilla.org/xbl">

  <binding id="ircStatsPanel">
    <content flex="1">
      <xul:vbox flex="1">
        <xul:browser anonid="ircStatsBrowser" disablehistory="true" type="content"
                     flex="1" tooltip="imTooltip"/>
      </xul:vbox>
    </content>

    <implementation>
      <method name="showStats">
        <parameter name="aTotal"/>
        <parameter name="aNoResponse"/>
        <parameter name="aCounts"/>
        <body>
        <![CDATA[
          let url = aPage.startsWith("about:") ? aPage : "about:" + aPage;
          this.browser.loadURI(url);
        ]]>
        </body>
      </method>

      <method name="refreshTitle">
        <body>
        <![CDATA[
          let browser = this.browser;
          this.tab.setAttribute("label",
            browser.contentTitle.replace("\0", "", "g") || browser.currentURI.spec);
          if (browser.currentURI.spec == "about:addons") {
            // Set the tab type to "addons" so that CSS will set its favicon.
            this.tab.setAttribute("type", "addons");
          }
        ]]>
        </body>
      </method>

      <method name="finishImport">
        <parameter name="aAboutPanel"/>
        <body>
        <![CDATA[
          this.browser.swapDocShells(aAboutPanel.browser);
          //this.refreshTitle();
        ]]>
        </body>
      </method>

      <property name="browser" readonly="true">
        <getter>
          return document.getAnonymousElementByAttribute(this, "anonid", "ircStatsBrowser");
        </getter>
      </property>
    </implementation>
  </binding>
</bindings>
